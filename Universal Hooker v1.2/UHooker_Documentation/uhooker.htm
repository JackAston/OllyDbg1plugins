<html>

<head>
<meta http-equiv="Content-Language" content="es-ar">
<title>.:: CORE SECURITY TECHNOLOGIES ::.</title>
<link rel="stylesheet" type="text/css" href="../images/style.css">
<style fprolloverstyle>
A:hover {color: #FF0000; text-decoration: underline}
.style1 {color: #FF0000}
.style3 {color: #666666}
</style>
</head>

<body topmargin="0" leftmargin="0" link="#F60000" vlink="#F60000">

<table border="0" width="770" cellspacing="0" cellpadding="0">
  <tr>
    <td colspan="2" bgcolor="#F60000">
      <p style="word-spacing: 0; margin-left: -7; margin-right: -7; margin-top: 0; margin-bottom: 0"><a href="../index.html"><img border="0" src="../images/header.gif" width="780" height="67"></a></p>
    </td>
  </tr>
  <tr>
    <td background="../images/bg_top.gif" colspan="2">
      <p style="word-spacing: 0; margin-left: -7; margin-right: -7; margin-top: 0; margin-bottom: 0"><map name="FPMap0">
      <area href="mailto:oss@coresecurity.com" shape="rect" coords="51, 8, 140, 26">
      <area href="../index.html" shape="rect" coords="14, 6, 41, 28"></map><img border="0" src="../images/header_bar.gif" usemap="#FPMap0" width="780" height="31"><span style="text-transform: uppercase"><font size="1">&nbsp;&nbsp;</font></span></p>
    </td>
  </tr>
  <tr>
    <td width="181" height="261" background="../images/br_left.gif" valign="top"><img border="0" src="../images/br_left.gif" width="186" height="6">
      <p>&nbsp;</p>
      <p style="margin-left: 0"><b><font size="3"><img border="0" src="../images/projects.gif" width="165" height="31"><br>
      </font></b></p>
      <p style="margin-left: 0">&nbsp;</p>
      <p style="margin-left: 0">&nbsp;</p>
      <div align="center">
        <center>
        <table width="155" height="163">
          <tr>
            <td width="100%" background="../images/bg_button.gif" height="25" style="border: 1 solid #808080"><b>&nbsp;&nbsp;&nbsp;
              <a href="pcapy.html"><font face="Arial" size="2">Pcapy</font></a></b></td>
          </tr>
        
          <tr>
            <td width="100%">
              <p style="margin-left: 0; margin-right: 0" align="left"><font size="1"><img alt src="../images/imItem2.gif" vspace="6" border="0" width="8" height="6"><a href="http://oss.coresecurity.com/projects/#What is Pcapy?"><font color="#000000">
              </font></a><a href="pcapy.html"><font color="#000000">Capture network packets from your Python programs on UNIX and
              Windows platforms</font></a></font></p>
            </td>
          </tr>
        <center>
          <tr>
            <td width="100%" height="18"></td>
          </tr>
          <tr>
            <td background="../images/bg_button.gif" height="25" style="border: 1 solid #808080"><b>&nbsp;&nbsp;&nbsp; <a href="impacket.html"><font face="Arial" size="2">Impacket</font></a></b></td>
          </tr>
          <tr>
            <td>
              <p style="margin-left: 0; margin-right: 0" align="left"><font size="1"><img alt src="../images/imItem2.gif" vspace="6" border="0" width="8" height="6"><font color="#000000"> </font><a href="impacket.html"><font color="#000000">Easily dissect and build network protocols in object&mdash;oriented Python</font></a></font></p></td>
          </tr>
        </center>
        <center>
          <tr>
            <td width="100%" height="18"></td>
          </tr>
          <tr>
            <td width="100%" background="../images/bg_button.gif" height="25" style="border: 1 solid #808080"><b>&nbsp;&nbsp;<font color="#666666">&nbsp;
              </font></b><font size="2" face="Arial"><a href="inlineegg.html"><b>InlineEgg</b></a></font></td>
          </tr>
        </center>
          <tr>
            <td width="100%">
              <p style="margin-left: 0; margin-right: 0" align="left"><font size="1"><img alt src="../images/imItem2.gif" vspace="6" border="0" width="8" height="6"><a href="inlineegg.html"><font color="#000000">
              A platform independent toolbox for writing assembly code in Python</font></a></font></p>
            </td>
          </tr>
        <center>
          <tr>
            <td width="100%" height="18"></td>
          </tr>
          <tr>
            <td background="../images/bg_button.gif" height="25" style="border: 1 solid #808080"><b>&nbsp;&nbsp;<font color="#666666">&nbsp; </font></b><font size="2" face="Arial"><strong> UHooker </strong></font></td>
          </tr>
          <tr>
            <td>
              <p style="margin-left: 0; margin-right: 0" align="left"><font size="1"><img alt src="../images/imItem2.gif" vspace="6" border="0" width="8" height="6"><span class="style1"> A tool to intercept and manipulate execution of programs. It enables the user to insert hooks in function calls and arbitrary addresses within the executable file in memory. The hooks handlers are written in Python and can be changed at runtime without the need to restart the inspected process. </span></font></p></td>
          </tr>
          <tr>
            <td height="18"></td>
          </tr>
          <tr>
            <td width="100%" background="../images/bg_button.gif" height="25" style="border: 1 solid #808080"><b>&nbsp;&nbsp;<font color="#666666">&nbsp;
              </font></b><font size="2" face="Arial"><a href="msyslog.html"><b>MSyslog</b></a></font></td>
          </tr>
        </center>
          <tr>
            <td width="100%">
              <p style="margin-left: 0; margin-right: 0" align="left"><font size="1"><img alt src="../images/imItem2.gif" vspace="6" border="0" width="8" height="6"><a href="msyslog.html"><font color="#000000">A replacement for the traditional syslog daemon featuring cryptographic log protection, database backends, and more</font></a></font></p>
            </td>
          </tr>
        <center>
          <tr>
            <td width="100%" height="18"></td>
          </tr>
          <tr>
            <td width="100%" height="18"></td>
          </tr>
        </table>
      </div>
    </td>

    <td width="580" height="261" valign="top" bgcolor="#EDEEEE">
      <h2><br>
      <br>
      What is uhooker?

</h2>
      <p>&nbsp;</p>
      <p class="style3">The Universal Hooker is a tool to intercept execution of programs. It enables the user
to intercept calls to API calls inside DLLs, and also arbitrary addresses within the executable file
in memory.
        <br>
      <p class="style3">
Why is it 'Universal'? There are different ways of hooking functions in a program, for example,
it can be done by setting software breakpoints (int 3h), hardware breakpoints (cpu regs), or
overwriting the prologue of a function to jump to a 'stub', etc. All the methods mentioned required
above, specially the latter, require the programmer of the code creating the hook to have 
certain knowledge of the function it is intercepting. If the code is written in a programming language
like C/C++, the code will normally need to be recompiled for every function one wants to intercept, etc.
  <br>
      <p class="style3">
The Universal Hooker tries to create very simple abstractions that allow a user of the tool
to write hooks for different API and non-API functions using an interpreted language (python),
without the need to compile anything, and with the possibility of changing the code that
gets executed whent the hooked function is called in run-time.
  <br>
      <p class="style3">
The Universal Hooker builds on the idea that the function handling the hook is the one with the knowledge about the parameters type of the function it
is handling. The Universal Hooker only knows the number of parameters of the function, and obtains them from the stack (all DWORDS). The hook handler is the
one that will interpret those DWORDS as the types received by the function.
  <br>
      <p class="style3">
The hook handlers are written in python, what eliminates the need for recompiling the handlers when a modification is required. And also, the hook handlers (executed by the server) are reloaded from disk every time a hook handler is
called, this means that one can change the behavior of the hook handler without
the need to recompile the code, or having to restart the application being analyzed.


  <br>
  <br>
  <strong>Win32 binaries</strong>
 	 <ul>
        <li class="style3"> Latest stable release (1.2), updated on September 06, 2006. See <a href="http://oss.coresecurity.com/uhooker/release/1.2/WHATSNEW_1.2.txt">What's new</a>.
        <a href="http://oss.coresecurity.com/uhooker/release/1.2/uhooker_v1.2.tgz">gzip'd tarball </a>, <a href="http://oss.coresecurity.com/uhooker/release/1
.2/uhooker_v1.2.zip">zip file </a> </li>
      </ul>
      <ul>
        <li class="style3"> 1.1, updated on June 30, 2006.
        <a href="http://oss.coresecurity.com/uhooker/release/1.1/uhooker_v1.1.tgz">gzip'd tarball </a>, <a href="http://oss.coresecurity.com/uhooker/release/1.1/uhooker_v1.1.zip">zip file </a> </li>
      </ul>      
     <ul>
        <li class="style3"> 1.0, updated on June 22, 2006.
        <a href="http://oss.coresecurity.com/uhooker/release/1.0/uhooker_v1.0.tg
z">gzip'd tarball </a>, <a href="http://oss.coresecurity.com/uhooker/release/1.0
/uhooker_v1.0.zip">zip file </a> </li>
      </ul>      
      <br>
      <strong>       <h2>Setup</h2>       
      </strong>
      <p><strong><br>
            <span class="style3">Quick start:</span></strong><span class="style3">Download the .zip file and extract to the ollydbg directory. The uhooker.dll
  must be in the ollydbg directory for it to be loaded as a plugin. and that's it!.
  Make sure that .py files in windows are associated with the python interpreter.
  For example, if you have a .py file and type 'myfile.py' and press enter on a cmd.exe
  window and it doesn't run, the association is not configured correctly.
  

            <br>
            <br>
            <strong>Requirements</strong>
            </span>
      </p>
      <ul>
  <li><span class="style3">Ollydbg 1.10 (available from</span> <a href="http://www.ollydbg.de" target="_blank">http://www.ollydbg.de</a>)</li>
  <li class="style3">A <a href="http://www.python.org/" target="_blank">Python</a> interpreter. Versions 2.3 and higher.</li>
  </ul>
      <h2> Documentation </h2>
      <p>Click the following link for an <a href="http://oss.coresecurity.com/uhooker/doc/index.html" target="_blank">online copy</a> of the documentation and scripts to be used with the uhooker. This page also contains an API reference and sample scripts that are frequently updated.</p>
      <p>&nbsp;</p>
      <h2>Known issues </h2>
      <p>Sometimes it does not work.</p>      <p>&nbsp;</p>
      <h2>Licensing </h2>
      <p>This software is provided under the following <a href="http://oss.coresecurity.com/uhooker/LICENSE" target="_blank">license</a> for non-commercial use.</p>
      <p>&nbsp;</p>
      <h2>Contact Us </h2>
      <p>Whether you want to report a bug, send a patch or give some suggestions on this package, drop us a few lines at <a href="mailto:oss@coresecurity.com">oss@coresecurity.com </a>. To contact me, the author, you can reach me at hochoa[ a t ]coresecurity.com</p>
      <p>&nbsp;</p>
      <p>
      <p>
    </td>
  </tr>
  <tr>
    <td width="778" height="19" valign="top" colspan="2" bgcolor="#4C505C">&nbsp;</td>
  </tr>
  <tr>
    <td width="778" height="26" valign="top" colspan="2" bgcolor="#919191">
      <p align="center"><b><font size="1" color="#CCCCCC">Core
      Security Technologies</font></b><font size="1" color="#CCCCCC">&nbsp;&copy;&nbsp;1998-2006&nbsp;&nbsp;|&nbsp;&nbsp;All
      rights reserved </font></p>
    </td>
  </tr>
</table>

</body>

</html>
